# TECHNICAL.md - æŠ€è¡“ä»•æ§˜æ›¸

> ğŸ“‹ **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è©³ç´°ä»•æ§˜æ›¸**: [APPLICATION_SPEC.md](./APPLICATION_SPEC.md)\
> ã‚ˆã‚Šè©³ç´°ãªæ©Ÿèƒ½ä»•æ§˜ãƒ»UI/UXãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼           | æŠ€è¡“ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒª                                                                          |
| :----------------- | :---------------------------------------------------------------------------------------- |
| **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰** | React, TypeScript, Tailwind CSS v4, Zustand, shadcn/ui, React Router v7, Socket.IO Client |
| **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**   | Node.js, Express, TypeScript, Socket.IO, Winston, YouTube Data API v3                     |
| **é–‹ç™ºãƒ„ãƒ¼ãƒ«**     | Vite, bun, ESLint, Prettier, Lucide React, React Icons                                    |

---

## ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•å‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
src/
â”œâ”€â”€ features/              # ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¥æ©Ÿèƒ½
â”‚   â”œâ”€â”€ music/             # éŸ³æ¥½ç®¡ç†ï¼ˆ/homeï¼‰
â”‚   â”‚   â”œâ”€â”€ components/    # HomeForm, YouTubeStatus, etc.
â”‚   â”‚   â”œâ”€â”€ hooks/         # use-youtube-status
â”‚   â”‚   â”œâ”€â”€ stores/        # musicStore
â”‚   â”‚   â”œâ”€â”€ api/           # YouTube APIé–¢é€£
â”‚   â”‚   â””â”€â”€ utils/         # éŸ³æ¥½å›ºæœ‰ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ schedule/          # æ™‚é–“å‰²ï¼ˆ/timeï¼‰
â”‚   â”‚   â”œâ”€â”€ components/    # TimeDisplay, ProgressBar, etc.
â”‚   â”‚   â”œâ”€â”€ hooks/         # use-class-schedule, time/*
â”‚   â”‚   â”œâ”€â”€ stores/        # classScheduleStore
â”‚   â”‚   â”œâ”€â”€ api/           # ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«API
â”‚   â”‚   â””â”€â”€ utils/         # æ™‚é–“è¨ˆç®—ãƒ»ç¥æ—¥å‡¦ç†
â”‚   â””â”€â”€ settings/          # å…±é€šè¨­å®šãƒ»ãƒ†ãƒ¼ãƒ
â”‚       â”œâ”€â”€ components/    # SettingsPanel, DarkModeToggle, etc.
â”‚       â”œâ”€â”€ hooks/         # use-progress-settings
â”‚       â”œâ”€â”€ stores/        # progressSettingsStore, colorModeStore
â”‚       â””â”€â”€ utils/         # è¨­å®šé–¢é€£ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ shared/                # å…±é€šãƒªã‚½ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ components/        # UIå…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆshadcn/ui, Footerï¼‰
â”‚   â”œâ”€â”€ hooks/             # use-gaming-toggle, use-mobile
â”‚   â”œâ”€â”€ stores/            # adminStore
â”‚   â”œâ”€â”€ libs/              # indexedDB, utils
â”‚   â”œâ”€â”€ types/             # å‹å®šç¾©, socket.ts
â”‚   â””â”€â”€ utils/             # æ±ç”¨é–¢æ•°
â”œâ”€â”€ server/                # ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰
â”‚   â”œâ”€â”€ api/               # APIãƒãƒ³ãƒ‰ãƒ©ãƒ¼
â”‚   â”œâ”€â”€ middleware/        # ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ utils/             # ã‚µãƒ¼ãƒãƒ¼ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â””â”€â”€ types/             # ã‚µãƒ¼ãƒãƒ¼å‹å®šç¾©
â””â”€â”€ app/                   # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤
    â”œâ”€â”€ routes/            # React Routerè¨­å®š
    â”œâ”€â”€ root.tsx           # ãƒ«ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    â””â”€â”€ routes.ts          # ãƒ«ãƒ¼ãƒˆå®šç¾©
```

---

## çŠ¶æ…‹ç®¡ç†ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ
  â†“
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆReact, Zustand, WebSocket/HTTPï¼‰
  â†“
ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆNode.js, Express, Socket.IOï¼‰
  â†“
YouTube Data API
```

### çŠ¶æ…‹ç®¡ç†ã®ãƒã‚¤ãƒ³ãƒˆ

- **Zustand**ã§å…¨UIçŠ¶æ…‹ã‚’ä¸€å…ƒç®¡ç†ï¼ˆã‚«ãƒ©ãƒ¼ãƒ¢ãƒ¼ãƒ‰ãƒ»é€²æ—è¨­å®šãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç­‰ï¼‰
- **IndexedDB**ã¯èƒŒæ™¯ç”»åƒã®ã¿ï¼ˆå¤§å®¹é‡å¯¾å¿œï¼‰
- **localStorage**ã¯Zustand persistçµŒç”±ã®ã¿åˆ©ç”¨

---

## APIãƒ»ãƒ‡ãƒ¼ã‚¿ä»•æ§˜

### WebSocket (Socket.IO)

- æ¥½æ›²è¿½åŠ ãƒ»å‰Šé™¤ãƒ»åˆæœŸåŒ–ãƒ»ã‚¨ãƒ©ãƒ¼é€šçŸ¥ï¼ˆã‚µãƒ¼ãƒãƒ¼â†’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰
- æ¥½æ›²è¿½åŠ ãƒ»å‰Šé™¤ãƒ»å†ç”ŸçŠ¶æ…‹æ›´æ–°ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆâ†’ã‚µãƒ¼ãƒãƒ¼ï¼‰

### REST API

- `/api/assets` : ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±å–å¾—
- `/internal/youtube/video-info?url=...` : YouTubeå‹•ç”»æƒ…å ±å–å¾—

### ãƒ‡ãƒ¼ã‚¿å‹ä¾‹

```typescript
interface Music {
    id: string;
    url: string;
    title: string;
    channel: string;
    duration: string;
    addedAt: Date;
}
```

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»èªè¨¼

- ç®¡ç†è€…æ¨©é™ã¯URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ç’°å¢ƒå¤‰æ•°ã§èªè¨¼
- æ¨©é™ã¯localStorageã§æ°¸ç¶šåŒ–
- APIã‚­ãƒ¼ãƒ»ç®¡ç†è€…ã‚³ãƒ¼ãƒ‰ã¯ã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒå¤‰æ•°ã§ç®¡ç†
- å…¥åŠ›æ¤œè¨¼ãƒ»å‹•ç”»æ™‚é–“åˆ¶é™ãƒ»ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ»æ“ä½œãƒ­ã‚°è¨˜éŒ²

---

## ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–

- æ¥½æ›²ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ `data/musicRequests.json` ã§æ—¥æ¬¡ãƒªã‚»ãƒƒãƒˆãƒ»å‹å®‰å…¨ä¿å­˜
- UIè¨­å®šã¯ Zustand persist/IndexedDB ã§ç®¡ç†

---

## é‹ç”¨ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- ãƒ­ã‚°ã¯Winstonã§ç®¡ç†ï¼ˆæœ¬ç•ª: ãƒ•ã‚¡ã‚¤ãƒ«, é–‹ç™º: ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼‰
- ãƒ•ãƒ­ãƒ³ãƒˆ: ã‚³ãƒ¼ãƒ‰åˆ†å‰²ãƒ»PurgeCSSãƒ»é…å»¶ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
- ãƒãƒƒã‚¯: APIã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚¯ã‚©ãƒ¼ã‚¿è¿½è·¡ãƒ»Socket.IOæ¥ç¶šç®¡ç†

---

## é–‹ç™ºãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
bun install
cp .env.example .env
bun run dev
```

### ãƒ“ãƒ«ãƒ‰ãƒ»æœ¬ç•ªèµ·å‹•

```bash
bun run typecheck
bun run build
bun run start
```

### å¿…é ˆç’°å¢ƒå¤‰æ•°

- `YOUTUBE_API_KEY`
- `ADMIN_SECRET`
- `PORT`ï¼ˆä»»æ„ï¼‰

---

---

**æœ€çµ‚æ›´æ–°:** 2025å¹´7æœˆ3æ—¥\
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** v2.1.0
